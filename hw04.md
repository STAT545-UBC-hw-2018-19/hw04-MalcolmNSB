HW04: Tidy data and joins
================

-   [Data reshaping](#data-reshaping)
    -   [La vie en France, ou au royaume-uni ?](#la-vie-en-france-ou-au-royaume-uni)
-   [Join Prompts](#join-prompts)

Data reshaping
--------------

**Problem:** You have data in one “shape” but you wish it were in another. Usually this is because the alternative shape is superior for presenting a table, making a figure, or doing aggregation and statistical analysis.

**Solution:** Reshape your data. For simple reshaping, gather() and spread() from tidyr will suffice. Do the thing that is possible / easier now that your data has a new shape.

**Prompt:** Make a tibble with one row per year and columns for life expectancy for two or more countries from gapminder.

First we load the tidyverse package and gapminder dataframe.

``` r
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(gapminder))
```

### La vie en France, ou au royaume-uni ?

``` r
fr_uk_lifeExp <- gapminder %>% 
  rename(Year = year) %>% 
  filter(country == "France" | country == "United Kingdom") %>% 
  select(Year, country, lifeExp) %>% 
  spread(key = "country", value = "lifeExp")
  colnames(fr_uk_lifeExp)
```

    ## [1] "Year"           "France"         "United Kingdom"

-   Use `knitr::kable()` to make this table look pretty in your rendered homework.

``` r
knitr::kable(fr_uk_lifeExp)
```

|  Year|  France|  United Kingdom|
|-----:|-------:|---------------:|
|  1952|  67.410|          69.180|
|  1957|  68.930|          70.420|
|  1962|  70.510|          70.760|
|  1967|  71.550|          71.360|
|  1972|  72.380|          72.010|
|  1977|  73.830|          72.760|
|  1982|  74.890|          74.040|
|  1987|  76.340|          75.007|
|  1992|  77.460|          76.420|
|  1997|  78.640|          77.218|
|  2002|  79.590|          78.471|
|  2007|  80.657|          79.425|

-   Take advantage of this new data shape to scatterplot life expectancy for one country against that of another.

``` r
fr_uk_lifeExp %>% 
ggplot(aes(`United Kingdom`, France)) +
  geom_point() +
  geom_smooth(method = loess) +
  ggtitle("Life expectancy trend of United Kingdom versus France, 1952-2007")
```

![](hw04_files/figure-markdown_github/unnamed-chunk-4-1.png)

Join Prompts
------------

**Problem:** You have two data sources and you need info from both in one new data object.

**Solution:** Perform a join, which borrows terminology from the database world, specifically SQL.

Prompts:

Activity \#1

Create a second data frame, complementary to Gapminder. Join this with (part of) Gapminder using a dplyr join function and make some observations about the process and result. Explore the different types of joins. Examples of a second data frame you could build: One row per country, a country variable and one or more variables with extra info, such as language spoken, NATO membership, national animal, or capitol city. One row per continent, a continent variable and one or more variables with extra info, such as northern versus southern hemisphere.

We shall build a second data frame of countries, with national animal, NATO membership

``` r
#x1 <- unique(select(gapminder, continent))
#`Northern Hemisphere` <- c("Yes", "Yes", "Yes", "Yes", "No")
#`Southern Hemisphere` <- c("Yes", "No", "Yes", "Yes", "Yes")
#mutate(x1,`Northern Hemisphere`, `Southern Hemisphere`)

#Creating our own tibble

#column of chosen countries
countries <- c("Canada", "United Kingdom", "France", "Russia")

#column of continents corresponding to chosen countries
continent<- c("Americas", "Europe", "Europe", "Asia") 

#Lan <- c("English, French", "English", "French") `Official Language(s)` = Lan

#column of national animal of corresponding country
Anim <- c("Beaver", "Lion", "Gallic Rooster", "Bear") #national animal of corresponding coutries chosen above

#column of NATO membership
NATO <- c("Yes", "Yes", "Yes", "No") 

#column of Capital city
Cap <- c("Ottawa", "London", "Paris", "Moscow") 

#create the tibble `addinfo` consisting of all the above columns
addinfo <- tibble(continent = continent, country = countries,  `national animal` = Anim, `NATO membership` = NATO, `capital city` = Cap)

knitr::kable(addinfo)
```

| continent | country        | national animal | NATO membership | capital city |
|:----------|:---------------|:----------------|:----------------|:-------------|
| Americas  | Canada         | Beaver          | Yes             | Ottawa       |
| Europe    | United Kingdom | Lion            | Yes             | London       |
| Europe    | France         | Gallic Rooster  | Yes             | Paris        |
| Asia      | Russia         | Bear            | No              | Moscow       |

``` r
#filter gapminder dataset to year 2007, and the countries in the countries column created earlier
gapfilt <- gapminder %>% 
  filter(year == 2007, country%in%countries | country == "Norway") %>% 
  
  #select subset of data in 2007
  select(continent, country, lifeExp)

knitr::kable(gapfilt)
```

| continent | country        |  lifeExp|
|:----------|:---------------|--------:|
| Americas  | Canada         |   80.653|
| Europe    | France         |   80.657|
| Europe    | Norway         |   80.196|
| Europe    | United Kingdom |   79.425|

``` r
#left join by country
left_join(gapfilt, addinfo, by = "country") %>% 
  knitr::kable()
```

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent.x | country        |  lifeExp| continent.y | national animal | NATO membership | capital city |
|:------------|:---------------|--------:|:------------|:----------------|:----------------|:-------------|
| Americas    | Canada         |   80.653| Americas    | Beaver          | Yes             | Ottawa       |
| Europe      | France         |   80.657| Europe      | Gallic Rooster  | Yes             | Paris        |
| Europe      | Norway         |   80.196| NA          | NA              | NA              | NA           |
| Europe      | United Kingdom |   79.425| Europe      | Lion            | Yes             | London       |

``` r
left_join(gapfilt, addinfo) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country        |  lifeExp| national animal | NATO membership | capital city |
|:----------|:---------------|--------:|:----------------|:----------------|:-------------|
| Americas  | Canada         |   80.653| Beaver          | Yes             | Ottawa       |
| Europe    | France         |   80.657| Gallic Rooster  | Yes             | Paris        |
| Europe    | Norway         |   80.196| NA              | NA              | NA           |
| Europe    | United Kingdom |   79.425| Lion            | Yes             | London       |

``` r
left_join(addinfo, gapfilt) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining character vector and factor, coercing
    ## into character vector

    ## Warning: Column `country` joining character vector and factor, coercing
    ## into character vector

| continent | country        | national animal | NATO membership | capital city |  lifeExp|
|:----------|:---------------|:----------------|:----------------|:-------------|--------:|
| Americas  | Canada         | Beaver          | Yes             | Ottawa       |   80.653|
| Europe    | United Kingdom | Lion            | Yes             | London       |   79.425|
| Europe    | France         | Gallic Rooster  | Yes             | Paris        |   80.657|
| Asia      | Russia         | Bear            | No              | Moscow       |       NA|

``` r
right_join(gapfilt, addinfo) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country        |  lifeExp| national animal | NATO membership | capital city |
|:----------|:---------------|--------:|:----------------|:----------------|:-------------|
| Americas  | Canada         |   80.653| Beaver          | Yes             | Ottawa       |
| Europe    | United Kingdom |   79.425| Lion            | Yes             | London       |
| Europe    | France         |   80.657| Gallic Rooster  | Yes             | Paris        |
| Asia      | Russia         |       NA| Bear            | No              | Moscow       |

``` r
right_join(addinfo, gapfilt)
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining character vector and factor, coercing
    ## into character vector

    ## Warning: Column `country` joining character vector and factor, coercing
    ## into character vector

    ## # A tibble: 4 x 6
    ##   continent country `national anima~ `NATO membershi~ `capital city`
    ##   <chr>     <chr>   <chr>            <chr>            <chr>         
    ## 1 Americas  Canada  Beaver           Yes              Ottawa        
    ## 2 Europe    France  Gallic Rooster   Yes              Paris         
    ## 3 Europe    Norway  <NA>             <NA>             <NA>          
    ## 4 Europe    United~ Lion             Yes              London        
    ## # ... with 1 more variable: lifeExp <dbl>

``` r
right_join(gapfilt, addinfo) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country        |  lifeExp| national animal | NATO membership | capital city |
|:----------|:---------------|--------:|:----------------|:----------------|:-------------|
| Americas  | Canada         |   80.653| Beaver          | Yes             | Ottawa       |
| Europe    | United Kingdom |   79.425| Lion            | Yes             | London       |
| Europe    | France         |   80.657| Gallic Rooster  | Yes             | Paris        |
| Asia      | Russia         |       NA| Bear            | No              | Moscow       |

``` r
inner_join(gapfilt, addinfo) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country        |  lifeExp| national animal | NATO membership | capital city |
|:----------|:---------------|--------:|:----------------|:----------------|:-------------|
| Americas  | Canada         |   80.653| Beaver          | Yes             | Ottawa       |
| Europe    | France         |   80.657| Gallic Rooster  | Yes             | Paris        |
| Europe    | United Kingdom |   79.425| Lion            | Yes             | London       |

``` r
inner_join(addinfo, gapfilt)
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining character vector and factor, coercing
    ## into character vector

    ## Warning: Column `country` joining character vector and factor, coercing
    ## into character vector

    ## # A tibble: 3 x 6
    ##   continent country `national anima~ `NATO membershi~ `capital city`
    ##   <chr>     <chr>   <chr>            <chr>            <chr>         
    ## 1 Americas  Canada  Beaver           Yes              Ottawa        
    ## 2 Europe    United~ Lion             Yes              London        
    ## 3 Europe    France  Gallic Rooster   Yes              Paris         
    ## # ... with 1 more variable: lifeExp <dbl>

``` r
full_join(gapfilt, addinfo) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country        |  lifeExp| national animal | NATO membership | capital city |
|:----------|:---------------|--------:|:----------------|:----------------|:-------------|
| Americas  | Canada         |   80.653| Beaver          | Yes             | Ottawa       |
| Europe    | France         |   80.657| Gallic Rooster  | Yes             | Paris        |
| Europe    | Norway         |   80.196| NA              | NA              | NA           |
| Europe    | United Kingdom |   79.425| Lion            | Yes             | London       |
| Asia      | Russia         |       NA| Bear            | No              | Moscow       |

``` r
bind_rows(gapfilt, addinfo) %>% 
  knitr::kable()
```

    ## Warning in bind_rows_(x, .id): binding factor and character vector,
    ## coercing into character vector

    ## Warning in bind_rows_(x, .id): binding character and factor vector,
    ## coercing into character vector

    ## Warning in bind_rows_(x, .id): binding factor and character vector,
    ## coercing into character vector

    ## Warning in bind_rows_(x, .id): binding character and factor vector,
    ## coercing into character vector

| continent | country        |  lifeExp| national animal | NATO membership | capital city |
|:----------|:---------------|--------:|:----------------|:----------------|:-------------|
| Americas  | Canada         |   80.653| NA              | NA              | NA           |
| Europe    | France         |   80.657| NA              | NA              | NA           |
| Europe    | Norway         |   80.196| NA              | NA              | NA           |
| Europe    | United Kingdom |   79.425| NA              | NA              | NA           |
| Americas  | Canada         |       NA| Beaver          | Yes             | Ottawa       |
| Europe    | United Kingdom |       NA| Lion            | Yes             | London       |
| Europe    | France         |       NA| Gallic Rooster  | Yes             | Paris        |
| Asia      | Russia         |       NA| Bear            | No              | Moscow       |

``` r
full_join(addinfo, gapfilt) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining character vector and factor, coercing
    ## into character vector

    ## Warning: Column `country` joining character vector and factor, coercing
    ## into character vector

| continent | country        | national animal | NATO membership | capital city |  lifeExp|
|:----------|:---------------|:----------------|:----------------|:-------------|--------:|
| Americas  | Canada         | Beaver          | Yes             | Ottawa       |   80.653|
| Europe    | United Kingdom | Lion            | Yes             | London       |   79.425|
| Europe    | France         | Gallic Rooster  | Yes             | Paris        |   80.657|
| Asia      | Russia         | Bear            | No              | Moscow       |       NA|
| Europe    | Norway         | NA              | NA              | NA           |   80.196|

``` r
semi_join(gapfilt, addinfo) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country        |  lifeExp|
|:----------|:---------------|--------:|
| Americas  | Canada         |   80.653|
| Europe    | France         |   80.657|
| Europe    | United Kingdom |   79.425|

``` r
semi_join(addinfo, gapfilt) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining character vector and factor, coercing
    ## into character vector

    ## Warning: Column `country` joining character vector and factor, coercing
    ## into character vector

| continent | country        | national animal | NATO membership | capital city |
|:----------|:---------------|:----------------|:----------------|:-------------|
| Americas  | Canada         | Beaver          | Yes             | Ottawa       |
| Europe    | United Kingdom | Lion            | Yes             | London       |
| Europe    | France         | Gallic Rooster  | Yes             | Paris        |

``` r
anti_join(gapfilt, addinfo) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country |  lifeExp|
|:----------|:--------|--------:|
| Europe    | Norway  |   80.196|

``` r
anti_join(addinfo, gapfilt) %>% 
  knitr::kable()
```

    ## Joining, by = c("continent", "country")

    ## Warning: Column `continent` joining character vector and factor, coercing
    ## into character vector

    ## Warning: Column `country` joining character vector and factor, coercing
    ## into character vector

| continent | country | national animal | NATO membership | capital city |
|:----------|:--------|:----------------|:----------------|:-------------|
| Asia      | Russia  | Bear            | No              | Moscow       |

``` r
bind_cols(gapfilt, addinfo) %>% 
  knitr::kable()
```

| continent | country        |  lifeExp| continent1 | country1       | national animal | NATO membership | capital city |
|:----------|:---------------|--------:|:-----------|:---------------|:----------------|:----------------|:-------------|
| Americas  | Canada         |   80.653| Americas   | Canada         | Beaver          | Yes             | Ottawa       |
| Europe    | France         |   80.657| Europe     | United Kingdom | Lion            | Yes             | London       |
| Europe    | Norway         |   80.196| Europe     | France         | Gallic Rooster  | Yes             | Paris        |
| Europe    | United Kingdom |   79.425| Asia       | Russia         | Bear            | No              | Moscow       |

``` r
a <- select(gapfilt, continent, country)
b <- select(addinfo, continent, country)

knitr::kable(a)
```

| continent | country        |
|:----------|:---------------|
| Americas  | Canada         |
| Europe    | France         |
| Europe    | Norway         |
| Europe    | United Kingdom |

``` r
knitr::kable(b)
```

| continent | country        |
|:----------|:---------------|
| Americas  | Canada         |
| Europe    | United Kingdom |
| Europe    | France         |
| Asia      | Russia         |

``` r
intersect(a,b) %>% 
  knitr::kable()
```

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country        |
|:----------|:---------------|
| Americas  | Canada         |
| Europe    | United Kingdom |
| Europe    | France         |

``` r
union(a,b) %>% 
  knitr::kable()
```

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country        |
|:----------|:---------------|
| Europe    | France         |
| Asia      | Russia         |
| Europe    | United Kingdom |
| Americas  | Canada         |
| Europe    | Norway         |

``` r
setdiff(a,b) %>% 
  knitr::kable()
```

    ## Warning: Column `continent` joining character vector and factor, coercing
    ## into character vector

    ## Warning: Column `country` joining character vector and factor, coercing
    ## into character vector

| continent | country |
|:----------|:--------|
| Europe    | Norway  |

``` r
setdiff(b,a) %>% 
  knitr::kable()
```

    ## Warning: Column `continent` joining factor and character vector, coercing
    ## into character vector

    ## Warning: Column `country` joining factor and character vector, coercing
    ## into character vector

| continent | country |
|:----------|:--------|
| Asia      | Russia  |
